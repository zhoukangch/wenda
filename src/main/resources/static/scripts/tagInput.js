define("nowcoder/1.2.983/javascripts/component/tagInput",["nc","cpn"],function(a,b,c){function d(a){a.maxTagLength=+a.maxTagLength||20}function e(){function a(){var a=c.tagList,b=a.length;if(!g.val()&&b>0){var d=a[b-1];c.delTag(d),c.suggest&&c.suggest.attach.fixPosition()}}function b(){var a=(c.suggest||{}).keyboardItem;if(!(a&&a.index>=0)){var b=r.trim(g.val());if(b){if(d.noCustom)return c.showError("暂不支持自定义，请选择已有标签");if(b.length>d.maxTagLength)return c.showError("标签最长"+d.maxTagLength+"个字符");var e=!!s.find(d.limitStr,function(a){return b.indexOf(a)>=0});if(e)return c.showError("标签中包含非法字符");c.addTag({text:b,value:b}),c.input.val(""),c.fixIptWidth(),c.suggest&&c.suggest.attach.fixPosition()}}}var c=this,d=c.rawConfig,e=c.getEl(),f=e.find(".js-tag-wrap"),g=(e.find(".js-input-wrap"),c.input),h=w.frequency(10);f.on("click",function(){g.focus()}),u.bindChange(g,function(){h(function(){c.fixIptWidth(),c.showError(!1)})});var i;g.on("focus",function(){window.clearTimeout(i),f.addClass("focus"),c.showError(!1)}).on("blur",function(){window.clearTimeout(i),i=window.setTimeout(function(){f.removeClass("focus"),c.suggest&&c.suggest.attach.forceHide(),c.fixIptWidth()},200)}),g.on("keydown",function(c){var d=c.keyCode+"",e={8:a,13:b}[d];e&&e()}),c.listen("change",function(){c.fixIptWidth()})}function f(){var a=this,b=a.rawConfig,c=a.getEl(),d=b.common||[],e=c.find(".js-common-tag"),f=d.length;if(c.find(".js-common-wrap")[0===f?"hide":"show"](),0!==f){var g=s.map(d,function(b){var c=s.isObject(b)?b:{text:b,value:b};return new y({renderTo:e,text:c.text,value:c.value,needToggle:!0,listeners:{toggle:function(){var b=this.isChecked();b&&a.addTag(c),!b&&a.delTag(a.getTagByVal(c.text))}}})});a.listen("change",function(){var b=s.toMap(a.tagList,function(a){return{key:a.val(),value:!0}});s.forEach(g,function(a){a.checked(!!b[a.val()])})})}}function g(){var a=this,b=a.rawConfig,c=a.input;b.getSuggest&&(a.suggest=x.show({input:c,needReWidth:!0,needSame:!0,noCache:!0,noLeave:!0,defaultIndex:b.noCustom?0:-1,reqList:function(c,d){b.getSuggest(c,function(b){var c=[],e=s.toMap(a.tagList,function(a){return{key:a.val()}});s.forEach(b,function(a){!e[a.value]&&c.push(a)}),d(c)})},ok:function(b){c.val(""),a.addTag({text:b.text,value:b.value}),a.fixIptWidth(),a.input.focus()}}),a.pushChild(a.suggest))}function h(a){var b=this;return 0===arguments.length?s.map(b.tagList,function(a){return a.val()}):(s.forEach(b.tagList,function(a){a&&a.destroy()}),b.tagList.length=0,void s.forEach(a,function(a){a&&s.isString(a)&&(a={value:a,text:a}),b.addTag(a)}))}function i(a){var b=this,c=a?!!b.getTagByVal(a.value):!1;if(!c&&a&&a.value&&a.text){var a=new y({renderTo:b.getEl(".js-input-wrap"),renderBy:"before",text:a.text,value:a.value,checked:!0,needDel:!0,listeners:{del:function(){b.delTag(this)}}});a.getEl().css("margin","2px"),b.tagList.push(a),b.fire("change")}}function j(a){var b=this,c=b.tagList;a&&s.contains(c,a)&&(b.tagList=s.without(c,a),a.destroy(),b.fire("change"))}function k(){var a=this;return!!(a.input.val()||a.tagList.length>0)}function l(a){var b=this;return s.find(b.tagList,function(b){return b.val()===a})}function m(){{var a=this;a.getEl()}a.fixIptWidth()}function n(){function a(a){var c=1,e=d[0],f=d.val();if(f!==b._lastVal){b._lastVal=f;var g=parseFloat(d.css("paddingLeft"))+parseFloat(d.css("paddingRight"));if(d.width(c).css("overflowX","hidden"),e.scrollWidth>c){var h=a&&e.scrollWidth>a,i=h?a-g:e.scrollWidth-g;d.width(i),d.css("overflowX",h?"auto":"hidden")}}}var b=this,c=b.getEl(),d=b.input,e=c.find(".tags-input-cont"),f=150,g=e.width(),h=b.hasVal();h&&a(g),!h&&d.outerWidth(f),!h&&(b._lastVal=null),d.attr("placeholder",h?"":"输入标签，回车确定")}function o(a){var b=this,c=b.getEl();c.find(".js-tag-wrap")[a?"addClass":"removeClass"]("error"),c.find(".js-error").html(a||"")}var p=a("nc"),q=a("cpn"),r=p.$,s=p.Base,t=p.Clazz,u=p.Dom,v=p.Component,w=p.Time,x=q.AttachSuggest,y=q.Tag,z=c.exports=t.create();t.mix(z,v,{_template:["<div>",'<div class="tags-input-wrap js-tag-wrap" style="margin:0;display:block;">','<label class="icon-tag"></label>','<div class="tags-input-cont" style="cursor:text">','<div class="tag-label-box js-tag-home">','<span class="js-input-wrap">','<input type="text" class="js-input" style="width:5px;" placeholder="输入标签，回车确定">',"</span>","</div>","</div>","</div>",'<div class="js-error" style="color:#ff5000;font-size:12px;"></div>','<div class="pop-common-wrap js-common-wrap" style="display:none;">',"<span>常用:</span>",'<div class="pop-common-label js-common-tag"></div>',"</div>","</div>"].join(""),listeners:[{name:"render",type:"custom",handler:function(){{var a=this,b=a.rawConfig;a.getEl()}a.input=a.getEl(".js-input"),a.tagList=[],a.resize(),a.initIpt(),a.initCommon(),a.initSuggest(),b.value&&a.val(b.value)}}]},{initialize:d,initIpt:e,initCommon:f,initSuggest:g,val:h,addTag:i,delTag:j,hasVal:k,getTagByVal:l,resize:m,fixIptWidth:n,showError:o})});